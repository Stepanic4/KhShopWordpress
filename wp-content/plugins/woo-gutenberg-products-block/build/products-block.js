!function(e,t){for(var r in t)e[r]=t[r]}(this,function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=748)}({0:function(e,t){!function(){e.exports=this.wp.element}()},107:function(e,t,r){var n=r(135),i=r(136),s=r(137);e.exports=function(e,t){return n(e)||i(e,t)||s()}},12:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},13:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},135:function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},136:function(e,t){e.exports=function(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return r}},137:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},138:function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?e.exports=n=function(e){return r(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},n(t)}e.exports=n},139:function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},14:function(e,t,r){var n=r(138),i=r(6);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},140:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,s=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?e:(i=0===s.indexOf("//")?s:0===s.indexOf("/")?r+s:n+s.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},141:function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},142:function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},143:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},15:function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},16:function(e,t,r){var n=r(139);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},37:function(e,t,r){var n=r(141),i=r(142),s=r(143);e.exports=function(e){return n(e)||i(e)||s()}},451:function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r.apply(this,arguments)}e.exports=r},462:function(e,t,r){var n=r(463);"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(69)(n,i);n.locals&&(e.exports=n.locals)},463:function(e,t,r){},6:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},69:function(e,t,r){var n,i,s={},a=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),o=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),c=null,l=0,u=[],d=r(140);function p(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=s[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(v(n.parts[a],t))}else{var o=[];for(a=0;a<n.parts.length;a++)o.push(v(n.parts[a],t));s[n.id]={id:n.id,refs:1,parts:o}}}}function h(e,t){for(var r=[],n={},i=0;i<e.length;i++){var s=e[i],a=t.base?s[0]+t.base:s[0],o={css:s[1],media:s[2],sourceMap:s[3]};n[a]?n[a].parts.push(o):r.push(n[a]={id:a,parts:[o]})}return r}function f(e,t){var r=o(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),u.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(e.insertAt.before,r);r.insertBefore(t,i)}}function b(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function y(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return r.nc}();n&&(e.attrs.nonce=n)}return m(t,e.attrs),f(e,t),t}function m(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function v(e,t){var r,n,i,s;if(t.transform&&e.css){if(!(s="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=s}if(t.singleton){var a=l++;r=c||(c=y(t)),n=w.bind(null,r,a,!1),i=w.bind(null,r,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",m(t,e.attrs),f(e,t),t}(t),n=function(e,t,r){var n=r.css,i=r.sourceMap,s=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||s)&&(n=d(n));i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}.bind(null,r,t),i=function(){b(r),r.href&&URL.revokeObjectURL(r.href)}):(r=y(t),n=function(e,t){var r=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){b(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=h(e,t);return p(r,t),function(e){for(var n=[],i=0;i<r.length;i++){var a=r[i];(o=s[a.id]).refs--,n.push(o)}e&&p(h(e,t),t);for(i=0;i<n.length;i++){var o;if(0===(o=n[i]).refs){for(var c=0;c<o.parts.length;c++)o.parts[c]();delete s[o.id]}}}};var g,_=(g=[],function(e,t){return g[e]=t,g.filter(Boolean).join("\n")});function w(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=_(t,i);else{var s=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(s,a[t]):e.appendChild(s)}}},748:function(e,t,r){"use strict";r.r(t);var n=r(107),i=r.n(n),s=r(451),a=r.n(s),o=r(6),c=r.n(o),l=r(12),u=r.n(l),d=r(13),p=r.n(d),h=r(14),f=r.n(h),b=r(15),y=r.n(b),m=r(16),v=r.n(m),g=r(0),_=(r(462),wp.i18n.__),w=wp.element.Component,O=wp.components.Dashicon,k=wp.apiFetch,j={},E=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={selectedProducts:e.selected_display_setting||[]},r}return v()(t,e),p()(t,[{key:"addOrRemoveProduct",value:function(e){var t=this.state.selectedProducts;t.includes(e)?t=t.filter(function(t){return t!==e}):t.push(e),this.setState({selectedProducts:t}),this.props.update_display_setting_callback(t.slice())}},{key:"render",value:function(){return Object(g.createElement)("div",{className:"wc-products-list-card wc-products-list-card--specific"},Object(g.createElement)(S,{addOrRemoveProductCallback:this.addOrRemoveProduct.bind(this),selectedProducts:this.state.selectedProducts}),Object(g.createElement)(T,{columns:this.props.attributes.columns,productIds:this.state.selectedProducts,addOrRemoveProduct:this.addOrRemoveProduct.bind(this)}))}}]),t}(w),S=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={searchText:"",dropdownOpen:!1},r.updateSearchResults=r.updateSearchResults.bind(c()(c()(r))),r.setWrapperRef=r.setWrapperRef.bind(c()(c()(r))),r.handleClickOutside=r.handleClickOutside.bind(c()(c()(r))),r.isDropdownOpen=r.isDropdownOpen.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"setWrapperRef",value:function(e){this.wrapperRef=e}},{key:"handleClickOutside",value:function(e){this.wrapperRef&&!this.wrapperRef.contains(e.target)&&this.setState({searchText:""})}},{key:"isDropdownOpen",value:function(e){this.setState({dropdownOpen:!!e})}},{key:"updateSearchResults",value:function(e){this.setState({searchText:e.target.value})}},{key:"render",value:function(){var e="wc-products-list-card__search-wrapper";return Object(g.createElement)("div",{className:e+(this.state.dropdownOpen?" "+e+"--with-results":""),ref:this.setWrapperRef},Object(g.createElement)("div",{className:"wc-products-list-card__input-wrapper"},Object(g.createElement)(O,{icon:"search"}),Object(g.createElement)("input",{type:"search",className:"wc-products-list-card__search",value:this.state.searchText,placeholder:_("Search for products to display"),onChange:this.updateSearchResults})),Object(g.createElement)(x,{searchString:this.state.searchText,addOrRemoveProductCallback:this.props.addOrRemoveProductCallback,selectedProducts:this.props.selectedProducts,isDropdownOpenCallback:this.isDropdownOpen}))}}]),t}(w),x=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={products:[],query:"",loaded:!1},r.updateResults=r.updateResults.bind(c()(c()(r))),r.getQuery=r.getQuery.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.updateResults()}},{key:"componentDidUpdate",value:function(){this.getQuery()!==this.state.query&&this.updateResults()}},{key:"getQuery",value:function(){return this.props.searchString.length?"/wc-pb/v3/products?per_page=10&status=publish&search="+this.props.searchString:""}},{key:"updateResults",value:function(){var e=this,t=this.getQuery();e.setState({query:t,loaded:!1}),t.length?k({path:t}).then(function(r){t===e.getQuery()&&e.setState({products:r,loaded:!0})}):e.setState({products:[],loaded:!0})}},{key:"render",value:function(){if(!this.state.loaded||!this.state.query.length)return null;if(0===this.state.products.length)return Object(g.createElement)("span",{className:"wc-products-list-card__search-no-results"}," ",_("No products found")," ");var e=!0,t=!1,r=void 0;try{for(var n,i=this.state.products[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=n.value;j[s.id]=s}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}return Object(g.createElement)(C,{products:this.state.products,addOrRemoveProductCallback:this.props.addOrRemoveProductCallback,selectedProducts:this.props.selectedProducts,isDropdownOpenCallback:this.props.isDropdownOpenCallback})}}]),t}(w),C=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.props.isDropdownOpenCallback(!0)}},{key:"componentWillUnmount",value:function(){this.props.isDropdownOpenCallback(!1)}},{key:"render",value:function(){var e=this.props,t=e.products,r=e.addOrRemoveProductCallback,n=e.selectedProducts,i=[],s=!0,a=!1,o=void 0;try{for(var c,l=t[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var u=c.value;i.push(Object(g.createElement)(P,{product:u,addOrRemoveProductCallback:r,selected:n.includes(u.id)}))}}catch(e){a=!0,o=e}finally{try{s||null==l.return||l.return()}finally{if(a)throw o}}return Object(g.createElement)("div",{role:"menu",className:"wc-products-list-card__search-results","aria-orientation":"vertical","aria-label":_("Products list")},Object(g.createElement)("div",null,i))}}]),t}(w),P=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).handleClick=r.handleClick.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"handleClick",value:function(){this.props.addOrRemoveProductCallback(this.props.product.id)}},{key:"render",value:function(){var e=this.props.product,t=this.props.selected?Object(g.createElement)(O,{icon:"yes"}):null;return Object(g.createElement)("div",{className:"wc-products-list-card__content"+(this.props.selected?" wc-products-list-card__content--added":""),onClick:this.handleClick},Object(g.createElement)("img",{src:e.images[0].src,alt:""}),Object(g.createElement)("span",{className:"wc-products-list-card__content-item-name"},e.name),t)}}]),t}(w),T=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={query:"",loaded:!1},r.updateProductCache=r.updateProductCache.bind(c()(c()(r))),r.getQuery=r.getQuery.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.updateProductCache()}},{key:"componentDidUpdate",value:function(){this.state.loaded&&this.getQuery()!==this.state.query&&this.updateProductCache()}},{key:"getQuery",value:function(){if(!this.props.productIds.length)return"";var e=[],t=!0,r=!1,n=void 0;try{for(var i,s=this.props.productIds[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var a=i.value;j.hasOwnProperty(a)||e.push(a)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}return e.length?"/wc-pb/v3/products?include="+e.join(","):""}},{key:"updateProductCache",value:function(){var e=this,t=this.getQuery();e.setState({query:t,loaded:!1}),t.length&&k({path:t}).then(function(t){if(t.length){var r=!0,n=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var o=s.value;j[o.id]=o}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}}e.setState({loaded:!0})})}},{key:"render",value:function(){var e=this,t=[],r=!0,n=!1,i=void 0;try{for(var s,a=function(){var r=s.value;if(!j.hasOwnProperty(r))return"continue";var n=j[r];t.push(Object(g.createElement)("li",{className:"wc-products-list-card__item",key:n.id+"-specific-select-edit"},Object(g.createElement)("div",{className:"wc-products-list-card__content"},Object(g.createElement)("img",{src:n.images[0].src,alt:""}),Object(g.createElement)("span",{className:"wc-products-list-card__content-item-name"},n.name),Object(g.createElement)("button",{type:"button",id:"product-"+n.id,onClick:function(){e.props.addOrRemoveProduct(n.id)}},Object(g.createElement)(O,{icon:"no-alt"})))))},o=this.props.productIds[Symbol.iterator]();!(r=(s=o.next()).done);r=!0)a()}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return Object(g.createElement)("div",{className:"wc-products-list-card__results-wrapper wc-products-list-card__results-wrapper--cols-"+this.props.columns},Object(g.createElement)("div",{role:"menu",className:"wc-products-list-card__results","aria-orientation":"vertical","aria-label":_("Selected products")},t.length>0&&Object(g.createElement)("h3",null,_("Selected products")),Object(g.createElement)("ul",null,t)))}}]),t}(w),N=r(37),R=r.n(N),A=wp.i18n.__,Q=wp.element.Component,D=wp.components.Dashicon,I=wp.apiFetch,L=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={selectedCategories:e.selected_display_setting,openAccordion:[],filterQuery:"",firstLoad:!0},r.checkboxChange=r.checkboxChange.bind(c()(c()(r))),r.accordionToggle=r.accordionToggle.bind(c()(c()(r))),r.filterResults=r.filterResults.bind(c()(c()(r))),r.setFirstLoad=r.setFirstLoad.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"checkboxChange",value:function(e,t){var r,n=this.state.selectedCategories;(n=n.filter(function(e){return!t.includes(e)}),e)&&(r=n).push.apply(r,R()(t));this.setState({selectedCategories:n}),this.props.update_display_setting_callback(n)}},{key:"accordionToggle",value:function(e){var t=this.state.openAccordion;t.includes(e)?t=t.filter(function(t){return t!==e}):t.push(e),this.setState({openAccordion:t})}},{key:"filterResults",value:function(e){this.setState({filterQuery:e.target.value})}},{key:"setFirstLoad",value:function(e){this.setState({firstLoad:!!e})}},{key:"render",value:function(){return Object(g.createElement)("div",{className:"wc-products-list-card wc-products-list-card--taxonomy wc-products-list-card--taxonomy-category"},Object(g.createElement)(M,{filterResults:this.filterResults}),Object(g.createElement)(U,{filterQuery:this.state.filterQuery,selectedCategories:this.state.selectedCategories,checkboxChange:this.checkboxChange,accordionToggle:this.accordionToggle,openAccordion:this.state.openAccordion,firstLoad:this.state.firstLoad,setFirstLoad:this.setFirstLoad}))}}]),t}(Q),M=function(e){var t=e.filterResults;return Object(g.createElement)("div",{className:"wc-products-list-card__input-wrapper"},Object(g.createElement)(D,{icon:"search"}),Object(g.createElement)("input",{className:"wc-products-list-card__search",type:"search",placeholder:A("Search for categories"),onChange:t}))},U=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={categories:[],loaded:!1,query:""},r.updatePreview=r.updatePreview.bind(c()(c()(r))),r.getQuery=r.getQuery.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.getQuery()!==this.state.query&&this.updatePreview()}},{key:"componentDidUpdate",value:function(){this.getQuery()!==this.state.query&&this.state.loaded&&this.updatePreview()}},{key:"getQuery",value:function(){return"/wc-pb/v3/products/categories"}},{key:"updatePreview",value:function(){var e=this,t=this.getQuery();e.setState({loaded:!1}),I({path:t}).then(function(r){e.setState({categories:r,loaded:!0,query:t})})}},{key:"render",value:function(){var e=this.props,t=e.filterQuery,r=e.selectedCategories,n=e.checkboxChange,i=e.accordionToggle,s=e.openAccordion,a=e.firstLoad,o=e.setFirstLoad;if(!this.state.loaded)return A("Loading");if(0===this.state.categories.length)return A("No categories found");var c=function e(t,r){var n=[];return r.filter(function(e){return e.parent===t.id}).forEach(function(t){n.push(t),n.push.apply(n,R()(e(t,r)))}),n},l=function(e){var t=e.category,r=e.categories,n="arrow-down-alt2";s.includes(t.id)&&(n="arrow-up-alt2");var a=null;return function(e,t){return!!c(e,t).length}(t,r)||(a={visibility:"hidden"}),Object(g.createElement)("button",{onClick:function(){return i(t.id)},className:"wc-products-list-card__accordion-button",style:a,type:"button"},Object(g.createElement)(D,{icon:n}))},u=this.state.categories;return""!==t&&(u=u.filter(function(e){return e.slug.includes(t.toLowerCase())})),Object(g.createElement)("div",{className:"wc-products-list-card__results"},Object(g.createElement)(function e(t){var d=t.categories,p=t.parent,h=d.filter(function(e){return e.parent===p});return a&&r.length>0&&(u.filter(function(e){return 0===e.parent}).forEach(function(e){var t=c(e,u),n=!0,a=!1,o=void 0;try{for(var l,d=t[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var p=l.value;if(r.includes(p.id)&&!s.includes(e.id)){i(e.id);break}}}catch(e){a=!0,o=e}finally{try{n||null==d.return||d.return()}finally{if(a)throw o}}}),o(!1)),h.length>0&&Object(g.createElement)("ul",null,h.map(function(t){return Object(g.createElement)("li",{key:t.id,className:s.includes(t.id)?"wc-products-list-card__item wc-products-list-card__accordion-open":"wc-products-list-card__item"},Object(g.createElement)("label",{className:0===t.parent?"wc-products-list-card__content":"",htmlFor:"product-category-"+t.id},Object(g.createElement)("input",{type:"checkbox",id:"product-category-"+t.id,value:t.id,checked:r.includes(t.id),onChange:function(e){return function(e,t,r){var i=c(t,r).map(function(e){return e.id});i.push(t.id),n(e.target.checked,i)}(e,t,d)},ref:function(e){return e&&(e.indeterminate=function(e,t){if(r.includes(e.id))return!1;var n=c(e,t).map(function(e){return e.id}),i=!0,s=!1,a=void 0;try{for(var o,l=n[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var u=o.value;if(r.includes(u))return!0}}catch(e){s=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(s)throw a}}return!1}(t,d))}})," ",t.name,0===t.parent&&Object(g.createElement)(l,{category:t,categories:d}),Object(g.createElement)("span",{className:"wc-products-list-card__taxonomy-count"},t.count)),Object(g.createElement)(e,{categories:d,parent:t.id}))}))},{categories:u,parent:0}))}}]),t}(Q),q=wp.i18n.__,F=wp.element.Component,B=wp.components.Dashicon,W=wp.apiFetch;function H(e,t){return e+","+t}function $(e){return e.split(",")[0]}var G=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={selectedAttribute:e.selected_display_setting.length?e.selected_display_setting[0]:"",selectedTerms:e.selected_display_setting.length>1?e.selected_display_setting.slice(1):[],filterQuery:""},r.setSelectedAttribute=r.setSelectedAttribute.bind(c()(c()(r))),r.addTerm=r.addTerm.bind(c()(c()(r))),r.removeTerm=r.removeTerm.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"setSelectedAttribute",value:function(e){this.setState({selectedAttribute:e,selectedTerms:[]}),this.props.update_display_setting_callback([e])}},{key:"addTerm",value:function(e){var t=this.state.selectedTerms;t.push(e),this.setState({selectedTerms:t});var r=[this.state.selectedAttribute];r=r.concat(t),this.props.update_display_setting_callback(r)}},{key:"removeTerm",value:function(e){var t=[],r=!0,n=!1,i=void 0;try{for(var s,a=this.state.selectedTerms[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var o=s.value;o!==e&&t.push(o)}}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}this.setState({selectedTerms:t});var c=[this.state.selectedAttribute];c=c.concat(t),this.props.update_display_setting_callback(c)}},{key:"updateFilter",value:function(e){this.setState({filterQuery:e.target.value})}},{key:"render",value:function(){return Object(g.createElement)("div",{className:"wc-products-list-card wc-products-list-card--taxonomy wc-products-list-card--taxonomy-atributes"},Object(g.createElement)(J,{updateFilter:this.updateFilter.bind(this)}),Object(g.createElement)(z,{selectedAttribute:this.state.selectedAttribute,selectedTerms:this.state.selectedTerms,filterQuery:this.state.filterQuery,setSelectedAttribute:this.setSelectedAttribute.bind(this),addTerm:this.addTerm.bind(this),removeTerm:this.removeTerm.bind(this)}))}}]),t}(F),J=function(e){return Object(g.createElement)("div",{className:"wc-products-list-card__input-wrapper"},Object(g.createElement)(B,{icon:"search"}),Object(g.createElement)("input",{className:"wc-products-list-card__search",type:"search",placeholder:q("Search for attributes"),onChange:e.updateFilter}))},z=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={attributes:[],loaded:!1,query:""},r.updatePreview=r.updatePreview.bind(c()(c()(r))),r.getQuery=r.getQuery.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.getQuery()!==this.state.query&&this.updatePreview()}},{key:"componentDidUpdate",value:function(){this.getQuery()!==this.state.query&&this.state.loaded&&this.updatePreview()}},{key:"getQuery",value:function(){return"/wc-pb/v3/products/attributes"}},{key:"updatePreview",value:function(){var e=this,t=this.getQuery();e.setState({loaded:!1}),W({path:t}).then(function(r){e.setState({attributes:r,loaded:!0,query:t})})}},{key:"render",value:function(){var e=this.props,t=e.selectedAttribute,r=e.filterQuery,n=e.selectedTerms,i=e.setSelectedAttribute,s=e.addTerm,a=e.removeTerm;if(!this.state.loaded)return Object(g.createElement)("ul",null,Object(g.createElement)("li",null,q("Loading")));if(0===this.state.attributes.length)return Object(g.createElement)("ul",null,Object(g.createElement)("li",null,q("No attributes found")));var o=r.toLowerCase(),c=[],l=!0,u=!1,d=void 0;try{for(var p,h=this.state.attributes[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var f=p.value;o.length&&-1===f.name.toLowerCase().indexOf(o)||c.push(Object(g.createElement)(K,{attribute:f,selectedAttribute:t,selectedTerms:n,setSelectedAttribute:i,addTerm:s,removeTerm:a}))}}catch(e){u=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw d}}return Object(g.createElement)("div",{className:"wc-products-list-card__results"},c)}}]),t}(F),K=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).handleAttributeChange=r.handleAttributeChange.bind(c()(c()(r))),r.handleTermChange=r.handleTermChange.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"handleAttributeChange",value:function(e){e.target.checked&&this.props.setSelectedAttribute(e.target.value)}},{key:"handleTermChange",value:function(e){e.target.checked?this.props.addTerm(e.target.value):this.props.removeTerm(e.target.value)}},{key:"render",value:function(){var e=this.props.selectedAttribute===H(this.props.attribute.slug,this.props.attribute.id),t=null;e&&(t=Object(g.createElement)(V,{attribute:this.props.attribute,selectedTerms:this.props.selectedTerms,addTerm:this.props.addTerm,removeTerm:this.props.removeTerm}));var r=["wc-products-list-card--taxonomy-atributes__atribute"];e&&r.push("wc-products-list-card__accordion-open");var n=H(this.props.attribute.slug,this.props.attribute.id);return Object(g.createElement)("div",{className:r.join(" ")},Object(g.createElement)("div",null,Object(g.createElement)("label",{className:"wc-products-list-card__content",htmlFor:"attribute-".concat(n)},Object(g.createElement)("input",{type:"radio",id:"attribute-".concat(n),value:n,onChange:this.handleAttributeChange,checked:e}),this.props.attribute.name)),t)}}]),t}(F),V=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={terms:[],loaded:!1,query:""},r.updatePreview=r.updatePreview.bind(c()(c()(r))),r.getQuery=r.getQuery.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.getQuery()!==this.state.query&&this.updatePreview()}},{key:"componentDidUpdate",value:function(){this.getQuery()!==this.state.query&&this.state.loaded&&this.updatePreview()}},{key:"getQuery",value:function(){return"/wc-pb/v3/products/attributes/"+this.props.attribute.id+"/terms"}},{key:"updatePreview",value:function(){var e=this,t=this.getQuery();e.setState({loaded:!1}),W({path:t}).then(function(r){e.setState({terms:r,loaded:!0,query:t})})}},{key:"render",value:function(){var e=this.props,t=e.selectedTerms,r=e.addTerm,n=e.removeTerm;if(!this.state.loaded)return Object(g.createElement)("ul",null,Object(g.createElement)("li",null,q("Loading")));if(0===this.state.terms.length)return Object(g.createElement)("ul",null,Object(g.createElement)("li",null,q("No terms found")));function i(e){e.target.checked?r(e.target.value):n(e.target.value)}return Object(g.createElement)("ul",null,this.state.terms.map(function(e,r){return Object(g.createElement)("li",{className:"wc-products-list-card__item",key:r},Object(g.createElement)("label",{className:"wc-products-list-card__content",htmlFor:"term-".concat(e.id)},Object(g.createElement)("input",{type:"checkbox",id:"term-".concat(e.id),value:e.id,onChange:i,checked:t.includes(String(e.id))}),e.name,Object(g.createElement)("span",{className:"wc-products-list-card__taxonomy-count"},e.count)))}))}}]),t}(F);r.d(t,"ProductPreview",function(){return ve});var X=wp.i18n.__,Y=wp.element,Z=Y.Component,ee=Y.RawHTML,te=wp.blocks.registerBlockType,re=wp.editor,ne=re.InspectorControls,ie=re.BlockControls,se=wp.components,ae=se.Toolbar,oe=se.Button,ce=se.Dashicon,le=se.RangeControl,ue=se.Tooltip,de=se.SelectControl,pe=wp.apiFetch,he={specific:{title:X("Individual products"),description:X("Hand-pick which products to display"),value:"specific"},category:{title:X("Product category"),description:X("Display products from a specific category or multiple categories"),value:"category"},filter:{title:X("Filter products"),description:X("E.g. featured products, or products with a specific attribute like size or color"),value:"filter",group_container:"filter"},featured:{title:X("Featured products"),description:"",value:"featured"},on_sale:{title:X("On sale"),description:"",value:"on_sale"},best_selling:{title:X("Best sellers"),description:"",value:"best_selling",no_orderby:!0},top_rated:{title:X("Top rated"),description:"",value:"top_rated",no_orderby:!0},attribute:{title:X("Attribute"),description:"",value:"attribute"},all:{title:X("All products"),description:X("Display all products ordered chronologically, alphabetically, by price, by rating or by sales"),value:"all"}};function fe(e){return!(he.hasOwnProperty(e)&&he[e].hasOwnProperty("no_orderby")&&he[e].no_orderby)}var be=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return v()(t,e),p()(t,[{key:"render",value:function(){var e=this,t="arrow-right-alt2";"filter"===this.props.value&&this.props.extended&&(t="arrow-down-alt2");var r="wc-products-display-options__option wc-products-display-options__option--"+this.props.value;return this.props.current===this.props.value&&(t="yes",r+=" wc-products-display-options__option--current"),Object(g.createElement)("div",{className:r,onClick:function(){e.props.current!==e.props.value&&e.props.update_display_callback(e.props.value)}},Object(g.createElement)("div",{className:"wc-products-display-options__option-content"},Object(g.createElement)("span",{className:"wc-products-display-options__option-title"},this.props.title),Object(g.createElement)("p",{className:"wc-products-display-options__option-description"},this.props.description)),Object(g.createElement)("div",{className:"wc-products-display-options__icon"},Object(g.createElement)(ce,{icon:t})))}}]),t}(Z),ye=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).setWrapperRef=r.setWrapperRef.bind(c()(c()(r))),r.handleClickOutside=r.handleClickOutside.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.props.existing&&document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){this.props.existing&&document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"setWrapperRef",value:function(e){this.wrapperRef=e}},{key:"handleClickOutside",value:function(e){this.wrapperRef&&!this.wrapperRef.contains(e.target)&&"wc-products-settings-heading__change-button button-link"!==e.target.getAttribute("class")&&this.props.closeMenu()}},{key:"render",value:function(){var e="wc-products-display-options";this.props.extended&&(e+=" wc-products-display-options--extended"),this.props.existing&&(e+=" wc-products-display-options--popover");var t=[];for(var r in he)t.push(Object(g.createElement)(be,a()({},he[r],{update_display_callback:this.props.update_display_callback,extended:this.props.extended,current:this.props.current,key:r})));var n=Object(g.createElement)("span",{className:"wc-products-display-options--popover__arrow"}),i=Object(g.createElement)("p",{className:"wc-products-block-description"},X("Choose which products you'd like to display:"));return Object(g.createElement)("div",{className:e,ref:this.setWrapperRef},this.props.existing&&n,!this.props.existing&&i,t)}}]),t}(Z),me=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={display:e.selected_display,menu_visible:!e.selected_display,expanded_group:""},r.updateDisplay=r.updateDisplay.bind(c()(c()(r))),r.closeMenu=r.closeMenu.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"updateDisplay",value:function(e){var t={display:e,menu_visible:!1,expanded_group:""},r="undefined"!==he[e].group_container&&he[e].group_container;r&&(t={menu_visible:!0,expanded_group:e},this.state.expanded_group===he[e].group_container&&(t.expanded_group="")),this.setState(t),r||this.props.update_display_callback(e)}},{key:"closeMenu",value:function(){this.setState({menu_visible:!1})}},{key:"render",value:function(){var e=this,t=null;"specific"===this.state.display?t=Object(g.createElement)(E,this.props):"category"===this.state.display?t=Object(g.createElement)(L,this.props):"attribute"===this.state.display&&(t=Object(g.createElement)(G,this.props));var r=this.state.menu_visible?Object(g.createElement)(ye,{extended:!!this.state.expanded_group,existing:!!this.state.display,current:this.state.display,closeMenu:this.closeMenu,update_display_callback:this.updateDisplay}):null,n=null;if(this.state.display){var i=["featured","on_sale","attribute","best_selling","top_rated"].includes(this.state.display)?this.state.display:"",s=Object(g.createElement)("button",{type:"button",className:"wc-products-settings-heading__change-button button-link",onClick:function(){e.setState({menu_visible:!e.state.menu_visible,expanded_group:i})}},X("Display different products"));n=Object(g.createElement)("div",{className:"wc-products-settings-heading"},Object(g.createElement)("div",{className:"wc-products-settings-heading__current"},X("Displaying "),Object(g.createElement)("strong",null,X(he[this.state.display].title))),Object(g.createElement)("div",{className:"wc-products-settings-heading__change"},s))}var a=Object(g.createElement)("button",{type:"button",className:"button wc-products-settings__footer-button",onClick:this.props.done_callback},X("Done"));if(["","specific","category","attribute"].includes(this.state.display)&&!this.props.selected_display_setting.length){var o={"":X("Please select which products you'd like to display"),specific:X("Please search for and select products to display"),category:X("Please select at least one category to display"),attribute:X("Please select an attribute")};a=Object(g.createElement)(ue,{text:o[this.state.display]},Object(g.createElement)("button",{type:"button",className:"button wc-products-settings__footer-button disabled"},X("Done")))}return Object(g.createElement)("div",{className:"wc-products-settings "+(this.state.expanded_group?"expanded-group-"+this.state.expanded_group:"")},Object(g.createElement)("h4",{className:"wc-products-settings__title"},Object(g.createElement)(ce,{icon:"screenoptions"})," ",X("Products")),n,r,t,Object(g.createElement)("div",{className:"wc-products-settings__footer"},a))}}]),t}(Z),ve=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return v()(t,e),p()(t,[{key:"render",value:function(){var e=this.props.product,t=null;return e.images.length&&(t=Object(g.createElement)("img",{src:e.images[0].src,alt:""})),Object(g.createElement)("div",{className:"product-preview",key:e.id+"-preview"},t,Object(g.createElement)("div",{className:"product-title"},e.name),Object(g.createElement)("div",{className:"product-price",dangerouslySetInnerHTML:{__html:e.price_html}}),Object(g.createElement)("span",{className:"product-add-to-cart"},X("Add to cart")))}}]),t}(Z),ge=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={products:[],loaded:!1,query:""},r.updatePreview=r.updatePreview.bind(c()(c()(r))),r.getQuery=r.getQuery.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.updatePreview()}},{key:"componentDidUpdate",value:function(){this.getQuery()!==this.state.query&&this.state.loaded&&this.updatePreview()}},{key:"getQuery",value:function(){var e=this.props.attributes,t=e.columns,r=e.rows,n=e.display,i=e.display_setting,s=e.orderby,a={status:"publish",per_page:r*t};"specific"===n?(a.include=i.join(","),a.per_page=i.length):"category"===n?a.category=i.join(","):"attribute"===n&&i.length?(a.attribute=$(i[0]),i.length>1&&(a.attribute_term=i.slice(1).join(","))):"featured"===n?a.featured=1:"on_sale"===n&&(a.on_sale=1),fe(n)&&("price_desc"===s?(a.orderby="price",a.order="desc"):"price_asc"===s?(a.orderby="price",a.order="asc"):"title"===s?(a.orderby="title",a.order="asc"):a.orderby=s);for(var o="?",c=Object.keys(a),l=0;l<c.length;l++){var u=c[l];o+=u+"="+a[u]+"&"}return"/wc-pb/v3/products"+o}},{key:"updatePreview",value:function(){var e=this,t=this.getQuery();e.setState({loaded:!1,query:t}),pe({path:t}).then(function(t){e.setState({products:t,loaded:!0})})}},{key:"render",value:function(){if(!this.state.loaded)return X("Loading");if(0===this.state.products.length)return X("No products found");var e="wc-products-block-preview cols-"+this.props.attributes.columns,t=this;return Object(g.createElement)("div",{className:e},this.state.products.map(function(e){return Object(g.createElement)(ve,{key:e.id,product:e,attributes:t.props.attributes})}))}}]),t}(Z),_e=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).state={categoriesInfo:[],categoriesQuery:"",attributeInfo:!1,attributeQuery:"",termsInfo:[],termsQuery:""},r.updateInfo=r.updateInfo.bind(c()(c()(r))),r.getQueries=r.getQueries.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(){var e=this.getQueries();this.state.categoriesQuery===e.categories&&this.state.attributeQuery===e.attribute&&this.state.termsQuery===e.terms||this.updateInfo()}},{key:"getQueries",value:function(){var e=this.props.attributes,t=e.display,r=e.display_setting,n={attribute:"",terms:"",categories:""};if("attribute"===t&&r.length){var i=r[0].split(",")[1],s=r.slice(1).join(", ");n.attribute="/wc-pb/v3/products/attributes/"+i,s.length&&(n.terms="/wc-pb/v3/products/attributes/"+i+"/terms?include="+s)}else"category"===t&&r.length&&(n.categories="/wc-pb/v3/products/categories?include="+r.join(","));return n}},{key:"updateInfo",value:function(){var e=this,t=this.getQueries();this.setState({categoriesQuery:t.categories,attributeQuery:t.attribute,termsQuery:t.terms}),t.categories.length?pe({path:t.categories}).then(function(t){e.setState({categoriesInfo:t})}):e.setState({categoriesInfo:[]}),t.attribute.length?pe({path:t.attribute}).then(function(t){e.setState({attributeInfo:t})}):e.setState({attributeInfo:!1}),t.terms.length?pe({path:t.terms}).then(function(t){e.setState({termsInfo:t})}):e.setState({termsInfo:[]})}},{key:"render",value:function(){var e=[he[this.props.attributes.display].title];if(this.state.categoriesInfo.length){var t=X("Product categories: "),r=[],n=!0,i=!1,s=void 0;try{for(var a,o=this.state.categoriesInfo[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;r.push(c.name)}}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}e=[t+=r.join(", ")]}else if(this.state.attributeInfo&&(e=[X("Attribute: ")+this.state.attributeInfo.name],this.state.termsInfo.length)){var l=X("Terms: "),u=[],d=!0,p=!1,h=void 0;try{for(var f,b=this.state.termsInfo[Symbol.iterator]();!(d=(f=b.next()).done);d=!0){var y=f.value;u.push(y.name)}}catch(e){p=!0,h=e}finally{try{d||null==b.return||b.return()}finally{if(p)throw h}}l+=u.join(", "),e.push(l)}return Object(g.createElement)("div",null,e.map(function(e,t){return Object(g.createElement)("div",{className:"scope-description",key:t},e)}))}}]),t}(Z),we=function(e){function t(e){var r;return u()(this,t),(r=f()(this,y()(t).call(this,e))).getInspectorControls=r.getInspectorControls.bind(c()(c()(r))),r.getToolbarControls=r.getToolbarControls.bind(c()(c()(r))),r.getBlockDescription=r.getBlockDescription.bind(c()(c()(r))),r.getPreview=r.getPreview.bind(c()(c()(r))),r.getSettingsEditor=r.getSettingsEditor.bind(c()(c()(r))),r}return v()(t,e),p()(t,[{key:"getInspectorControls",value:function(){var e=this.props,t=e.attributes,r=e.setAttributes,n=t.rows,i=t.columns,s=t.display,a=t.orderby,o=Object(g.createElement)(le,{label:X("Columns"),value:i,onChange:function(e){return r({columns:e})},min:wc_product_block_data.min_columns,max:wc_product_block_data.max_columns}),c=null;fe(s)&&(c=Object(g.createElement)(de,{key:"query-panel-select",label:X("Order Products By"),value:a,options:[{label:X("Newness - newest first"),value:"date"},{label:X("Price - low to high"),value:"price_asc"},{label:X("Price - high to low"),value:"price_desc"},{label:X("Rating - highest first"),value:"rating"},{label:X("Sales - most first"),value:"popularity"},{label:X("Title - alphabetical"),value:"title"}],onChange:function(e){return r({orderby:e})}}));var l=null;return"specific"!==s&&(l=Object(g.createElement)(le,{label:X("Rows"),value:n,onChange:function(e){return r({rows:e})},min:wc_product_block_data.min_rows,max:wc_product_block_data.max_rows})),Object(g.createElement)(ne,{key:"inspector"},this.getBlockDescription(),Object(g.createElement)("h3",null,X("Layout")),o,l,c)}},{key:"getToolbarControls",value:function(){var e=this.props,t=e.attributes,r=e.setAttributes,n=t.display,i=t.display_setting,s=t.edit_mode,a=["","specific","category","attribute"].includes(n)&&!i.length,o=[{icon:"edit",title:X("Edit"),onClick:a?function(){}:function(){return r({edit_mode:!s})},isActive:s}];return Object(g.createElement)(ie,{key:"controls"},Object(g.createElement)(ae,{controls:o}))}},{key:"getBlockDescription",value:function(){var e=this.props,t=e.attributes,r=e.setAttributes;if(!t.display.length)return null;var n=null;return t.edit_mode||(n=Object(g.createElement)("div",{className:"wc-products-scope-description--edit-quicklink"},Object(g.createElement)(oe,{isLink:!0,onClick:function(){r({edit_mode:!0})}},X("Edit")))),Object(g.createElement)("div",{className:"wc-products-scope-descriptions"},Object(g.createElement)("div",{className:"wc-products-scope-details"},Object(g.createElement)("h3",null,X("Current Source")),Object(g.createElement)(_e,{attributes:t})),n)}},{key:"getPreview",value:function(){return Object(g.createElement)(ge,{key:"preview",attributes:this.props.attributes})}},{key:"getSettingsEditor",value:function(){var e=this.props,t=e.attributes,r=e.setAttributes,n=t.display,i=t.display_setting;return Object(g.createElement)(me,{key:"settings-editor",attributes:t,selected_display:n,selected_display_setting:i,update_display_callback:function(e){n!==e&&r({display:e,display_setting:[],edit_mode:["specific","attribute","category"].includes(e)})},update_display_setting_callback:function(e){return r({display_setting:e})},done_callback:function(){return r({edit_mode:!1})}})}},{key:"render",value:function(){var e=this.props.attributes.edit_mode;return[this.getInspectorControls(),this.getToolbarControls(),e?this.getSettingsEditor():this.getPreview()]}}]),t}(Z);te("woocommerce/products",{title:X("Products"),icon:"screenoptions",category:"widgets",description:X("Display a grid of products from a variety of sources."),attributes:{columns:{type:"number",default:wc_product_block_data.default_columns},rows:{type:"number",default:wc_product_block_data.default_rows},display:{type:"string",default:""},display_setting:{type:"array",default:[]},orderby:{type:"string",default:"date"},edit_mode:{type:"boolean",default:!0}},edit:function(e){return Object(g.createElement)(we,e)},save:function(e){var t=e.attributes,r=t.rows,n=t.columns,s=t.display,a=t.display_setting,o=t.orderby,c=new Map;if("specific"!==s&&c.set("limit",r*n),c.set("columns",n),"specific"===s)c.set("ids",a.join(","));else if("category"===s)c.set("category",a.join(","));else if("featured"===s)c.set("visibility","featured");else if("on_sale"===s)c.set("on_sale","1");else if("best_selling"===s)c.set("best_selling","1");else if("top_rated"===s)c.set("top_rated","1");else if("attribute"===s){var l=a.length?$(a[0]):"",u=a.length>1?a.slice(1).join(","):"";c.set("attribute",l),u.length&&c.set("terms",u)}fe(s)&&("price_desc"===o?(c.set("orderby","price"),c.set("order","DESC")):"price_asc"===o?(c.set("orderby","price"),c.set("order","ASC")):"date"===o?(c.set("orderby","date"),c.set("order","DESC")):c.set("orderby",o));var d="[products",p=!0,h=!1,f=void 0;try{for(var b,y=c[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var m=i()(b.value,2);d+=" "+m[0]+'="'+m[1]+'"'}}catch(e){h=!0,f=e}finally{try{p||null==y.return||y.return()}finally{if(h)throw f}}return d+="]",Object(g.createElement)(ee,null,d)}})}}));